<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Doteur live example</title>
	<script src="https://cdn.jsdelivr.net/npm/@hpcc-js/wasm/dist/index.min.js"></script>
    <script>
        var hpccWasm = window["@hpcc-js/wasm"];
    </script>
  </head>
  <body>
    <textarea id="userinput" placeholder="Copy paste your SQL schema here"></textarea>
    <div id="dotoutput"></div>
    <script type="module">
      import init, {convert_sql_to_dot} from "./pkg/doteur_wasm.js";
      function doteur(data, legend, dark_mode){
      init()
        .then(() => {
	const dot = convert_sql_to_dot(data, legend, dark_mode);
	hpccWasm.graphviz.layout(dot, "svg", "dot").then(svg => {
            const div = document.getElementById("dotoutput");
            div.innerHTML = svg;
	    });
	});
	}
	let userInput = document.getElementById("userinput");
	userInput.addEventListener("input", function() {
		doteur(userInput.value, false, false);
	});
	</script>
  </body>
</html>


